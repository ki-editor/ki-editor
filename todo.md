- [x] scrolling view
- [x] swapping?
- [x] transactional edit: so that exchanging siblings can be undone in one step
      instead of two smaller steps
- [x] multi-cursor
- [x] swap d to ^x, y to ^c
- [x] ^f for find
- [x] f/F for moving forward/backward (so that it's consistent with other
      actions, which is selection mode first, then action)
- [x] moving selection should scroll the page when out of view
- [x] remove windows, as it is useless
- [x] e for eating forward, useful for replacing current node with parent, also might make `d` obsolete
- [x] implement buffer
- [x] use patch for undo (undo history should be stored under buffer) (https://docs.rs/diffy/0.3.0/diffy/)
- [x] implement component
- [x] file picker
- [x] each editor should have a title (filename, prompt etc)
- [x] split window (needed for autocomplete, prompt)
  - parent-child architecture
  - each window can have multiple children window
  - when a window is closed, all of its children are closed
  - each window have a group, if any of the window in the same group is closed
    all windows in the same group should be closed
- [x] autocomplete
- [x] engine: press Enter to open new line below
- [x] fix(editor): backward token buggy
- [x] LSP (after window system implemented)
- [x] engine: d for delete (because I miss delete, eat is weird)
- [x] feat(editor/normal): backspace should not yank
- [x] fix(editor): swap sibling will skip sibling sometimes
- [x] fix(editor): p e ^z e , does not work as expected
- [x] LSP hover
- [x] LSP Diagnostics highlight error range
- [x] LSP Diagnostics show error message
- [x] LSP completion pass in trigger characters, so that typing . or :: provides better completion in Rust
- [x] LSP completion allow edit
- [x] remove e, make px the same as pe
- [x] LSP go to definition
- [x] LSP get references
- [x] screen '[' and ']' not working as expected, now cannot type []
- [x] refactor: SuggestiveEditor and Prompt should use the same underlying component
- [x] screen: show editor error to user
- [x] Format on save
- [x] feat(ui): decorate both sides of a selection with cursor, so that shrinking selection is more obvious
- [x] i = insert at end of selection, I = insert at beginning of selection
- [x] LSP rename
- [x] LSP signature help
- [x] LSP quick action
- [x] ([{ for enclosing current selection with brackets
- [x] crash when formatting
- [x] create a key event macro so that handle_event can be less tedious: e.g. key!(ctrl-a) => do_something()
- [x] perf: rendering is laggy when there's too many diagnostics
- [x] feat(editor/diagnostics-movement): should work for overlapped ranges, A:0-3, B:1-3, C:4-5, starting from A, forward should go to B first before C
- [x] feat(editor): f = go to final selection, F = go to first selection. e.g. sf = final sibling, mf = final match
- [x] feat(editor/delete): allow edit even if there's no next sibling, in this case, collapse the selection
- [x] when cursor at last position, and after formatting the cursor is out of bound, should not crash
- [x] refactor: change all rope.x_to_y to rope.try_x_to_y to avoid crashing
- [x] perf: when LSP is enable, handling key event is very slow
- [x] infinite loop when changing window
- [x] feat(editor): \* to search for the current selection (using AST grep maybe?)
- [x] feat(lsp): go to declaration, type definition of symbol, and implementations
- [x] feat(search): don't use regex, regex is not needed 90% of the time
- [x] feat(editor/word): word should move by camelCase / snake_case, so we can select a word within a variable name
- [x] layout: implement Tall, instead of binary partition
- [x] case transformation group: UPPERCASE, Capital Case, lowercase, camelCase, PascalCase, snake_case, kebab-case (https://docs.rs/convert_case/latest/convert_case/enum.Case.html)
- [x] feat(lsp): search symbols
- [x] feat(editor): global regex search
- [x] soft wrap
- [x] feat(editor): global literal search
- [x] feat(editor): global ast-grep search
- [x] feat(editor): add cursor mode, n = add next, p = add previous
- [x] feat(edtior): add editor cursor mode, ae, where n/p = go to next/previous cursor, d = delete current cursor
- [x] feat(editor): remove shift+i by replacing it with ip, in
- [x] feat(g): 'gfo' for opened editors
- [x] feat(g): 'gfs' for git status files
- [x] feat(f): hide built-in regex like word and character under f, then we can add more like numbers, dates, etc
- [x] incorporate AST grep (https://github.com/ast-grep/ast-grep)
- [x] feat(signature-help): not showing type
- [x] feat(key): change ctrl+t to space-t
- [x] feat(editor): "go" for getting opened files, "gg" for getting git status files
- [x] feat(editor): vb = align bottom, vc = align center, vt = align top
- [x] mechanism for adding selection to all matching selection within current selection (a-a)
- [x] copy should work between different editors
- [x] Enter not working as expected in insert mode
- [x] dropdown: handle up/down/enter event
- [x] feat(editor): go to specific line number
- [x] feat(editor): scroll mode, press vp, vl to enter scroll page/line mode
- [x] refactor(selection): privatized range, rename extended_range method as range
- [x] feat(keymap): zn/zp = last selection / first selection
- [x] feat: change k to d, because d is easier to reach in Dvorak, and d (delete) is a more straightforward mnemonics than k (kill)
- [x] keymap: shift keys are hard to press, bring back hjkl, but hjkl works on object now! For example, press q to go to quickfix-list mode
      press j/k to go to prev/next item, press h/l to go to prev/next quickfix list, question: how does this works for action like delete/swap?
      for motions, h/l = next object, j/k = first object on next/prev line
      this is tried before, but it seems like up/down is only applicable to SyntaxTree mode
- [x] feat(editor): match current selection (\*) should open keymap legend
- [x] feat: bn/bp browswer-like for file navigation (use the undo crate https://crates.io/crates/undo)

  for node movement: h = parent, l = kid, j/k = next/prev sibling

- [x] fix(legend): pressing esc causes the cursor to fly to nowhere, then has to press ctrl+w to bring it back
- [x] feat(editor): remove down/up movement
- [x] feat(movement): mi for go to specific 1-based index
- [x] feat(keymap): remap m to ff, remap z to m, so that m stands for Movement, mf = first, ml = last, mm = middle
- [x] feat(swap): x, then movement, movement = n p mf ml
- [x] file explorer
- [x] feat(title): show git branch if possible
- [x] feat: command mode (for exiting editor, save all file etc)
- [x] feat(lsp/rename): show current name in prompt
- [x] LSP file modifications (add,rename,delete)
- [x] fix: cursor not wrapped properly
- [x] feat(cursor): change cursor style in insert mode
- [x] feat(grammar): should be prebuilt during build stage, no need for user to run "grammar fetch/build" command
- [x] feat(render): breadcrumb, show lines of ancestors of the current node that are out of bound
- [x] feat: highlight parent lines
- [x] fix(syntax-highlighting): flashing during editing
- [x] fix: diagnostic not updated immediately, need to save a few times to get the latest diagnostics
- [x] fix(diagnostic): cannot move to next diagnostics sometimes
- [x] fix(editor): enter normal mode should highlight one character, otherwise pressing 'a' afterwards feels unexpected
- [x] feat(syntax-highlight-queries): take from the repos, don't store it
- [x] fix(cursor): misplacement when wrapped sometimes
- [x] fix(selection_mode/line): cannot select last line of new file (try go to last line in file explorer)
- [x] think(movement): revive u and d? Because I find myself needing u and d sometimes, e.g. token below, also this is better for syntax traversal, no need for two separated mode
- [x] fix: cannot enter new line in new file
- [x] fix(suggestive_editor): autocomplete inserting emoji icons
- [x] feat(line): line-up/down go to parent/child lines! yes
- [x] fix(editor): paste from terminal inserts one by one
- [x] fix(signature-help): cannot be closed by pressing esc key
- [x] la should open cursor at end of line, not beginning of next line
- [x] fix(editor): copy-paste does not work all the time (probably due to the interaction with system clipboard)
- [x] fix(editor): scrolling to end always gives error (annoying!)
- [x] feat(layout): toggle layout automatically depending on terminal dimension
- [x] minor(keybinding): change fr to fx, so that fr can be find local references
- [x] fix: cannot transition from global mode to local mode properly
- [x] feat(keymap): ctrl+d/u = scroll down/up
- [x] ctrl+l = align view top/center/bottom/original (srcoll offset = enum {Top,Bottom,Center,Custom})
- [x] feat(keymap): change i -> a, a -> e, so that it matches ctrl+a and ctrl+e in insert mode?
- [x] feat(kill): should till next in Syntax Tree mode
- [x] fix(kill): should collapse selection when killing extended range
- [x] feat(line): should not include leading whitespace (to synergize better with new jumping ux)
- [x] fix(render): cursor out of bound sometimes due to contextual parent lines
- [x] feat(git_hunk): trim leading whitespaces when showing diff
- [x] test(render): with wrapped lines, decorations are rendered properly, and cursor position too
- [x] fix(editor): cursor is missing when content is empty
- [x] fix(key): crash when super is pressed
- [-] feat(remove-surronding-brackets): press ])}> to remove the brackets of the current selection
- [-] feat(x): xi{ = select inside {, xa( = select around {. c = curly, p = parenthesis, s = square, a = angular, q = single quote, d = double quote, b = backtick. Or any character, for example like \*, even space
- [-] feat(x): m jumps to matching enclosure (e.g. bracket, quote)
- [-] feat(editor): trim, which trims both ends of every selection by 1 character
- [-] feat(layout): the height of prompt window should be one
- [x] feat(selection_mode/character): let first/last be the first/last char of the current line, similar behavior like SyntaxType, this is so that to get to the last char, we can do `con`
- [x] feat(movement): move first/last accessible with 1 keypress, perhaps y=first and z=last? But z is hard to combo with last
- [x] feat(keymap): change e->x, i->a, a->e, x->z (zephyr/misc), op -> i = initial (first selection), on -> o = omega (last selection), oi -> 0 = index
- [x] feat: how to enter newline in insert mode?!
- [-] feat(keymap): y = yeet away the both end by one character for each selection(s)

# Grammar loading

- [x] should I use helix languages.toml or should I build the list myself again? (build myself, because Rust is much better than toml, especially at reducing duplications)
- [x] store the runtime grammars file not at helix editor config dir, use 'directories'
- [x] remove the BUILD_TARGET env value that is needed when building
- [x] Make language a const struct instead of trait, to reduce boilerplate and enable reuse
- [] g for selecting the next node that is the same generation (descendant
  level from root) as the current node
- [] e for elevate the current node such that it becomes the siblings of its parent
- [] e for enclose the current node with one of the brackets
- [] f for moving to the next node which has the same field name as the current node
- [] . for selecting the whole file
- [] multi eat parent should not proceed if the final edit overlaps (not too important because we use patch for undo/redo now, so messed up stuff can be undone)
- [] jump should work for multiple selection?
- [] incorporate first-class refactoring (https://github.com/ThePrimeagen/refactoring.nvim)
- [] feat(editor): tree rotation, e.g. a + (b - c) => b - (a + c)
- [] feat(selection): quickfix list item as a type of selection, undo & add selection works across files
- [] feat: workspaces (similar to tab in Vim)
- [] bug: going back to previous selection remove the copied text
- [] Suggestive editor, pressing Enter when there's no filtered item should not get the item
- [] apply actions to all quickfix list items
- [] multi-autocomplete with insert
- [] feat(editor/slurp or barf):
  - exchange last nameless sibling (closing bracket), with the next sibling of parent
    - and reverse
  - exchange first nameless sibling (opening bracket), with the previous sibling of parent
    - and reverse
- [] editor(bug): go to previous error always step to the next first before going to the first
- [] editor(lift): move an expression upwards, can be implemented by swapping
  the "section before the current node until its parent" with "current node"
- [] add integration test for every LSP Actions
- [] refactor: handle_event should not mutate the component, but should return dispatch instead, like Elm.
  - This is to standardize the event handling architecture, and also allow keymap to be defined declaractively
- [] feat(lsp/completion): snippet support
- [] treesitter injections, support nested languages like Rust in Markdown
- [] feat(lsp/code-action): command string execution (code action without edit)
- [] feat(buffer): use tree-sitter incremental parsing to improve performance
- [] feat(completion): Github Copilot! (contact AlexanderDickie from https://github.com/helix-editor/helix/pull/6865 when Tim is matured enough to accept contributors)

- [] each selection mode to have action(s), for example for git hunk, actions are stage-hunk/discard-hunk.
- [] swap jump: press '>', and then jump labels appear, pressing the jump label swaps the current selection with that selection
- [] filter selections/quickfix-list: useful for multi-cursor
- [] fix(buffer/bookmarks): bookmarks not updated upon undo/redo/formatted
- [] feat(g): 'ggh' for global git hunks
- [] feat(space-f): for file mode, r = rename, d = delete, a = add, s = save
- [] feat(doc): add motto about having no shift keys for key bindings;
  spammable key like n/p will not hide under layers, but action like "Change
  selection mode to Git Hunk" which is not supposed to be spam should hide
  under layer
- [] feat(keymap): put copy,paste,cut under space, undo/redo a new mode
- [] feat(multicursor): lag because selection set is unnecessarily recomputed for every cursor
- [] feat(keymap): if u = parent, then zu the outermost node that starts with this cursor
- [] feat(find): sentence, paragraph
- [] refactor(buffer): hide rope
- [] fix failing test cases
- [] file explorer (integrate with LSP)
- [] fix: paste from clipboard does not work properly if contains newline
- [] fs watcher, watch for file changes
- [] devise a theme palette rank (light/dark), auto-rank, e.g. in light mode, lightest color is background, darkest color is default
- [] feat(prompt): with initial content, the cursor should be at the end of the line, not the beginning
- [] feat(title): show Language
- [] feat(multicursor): split
- [] fix: log if formatting failed
- [] feat(suggestive_editor): text completion (based on words)
- [] feat(editor/find): tree-sitter query
- [] feat(movement): leftmost and rightmost (for things like: last word of the line)
- [] feat(highlight-queries & lsp): piggyback off helix editor, don't reinvent the wheel
- [] fix(suggestive_editor): pressing enter after pressing dot replaces the first word before cursor position with the first completion (expected the completion to be inserted after the dot)
- [] feat(editor/insert/shortcuts): alt-delete, home, end, alt-left, alt-right
- [] feat(layout): split vertically by half, then split horizontally by half (so that explorer can be on the right)
- [] feat(highlight-queries & lsp): clone from nvim-treesitter or helix
- [] feat(package): incorporate Mason, see https://www.reddit.com/r/neovim/comments/122ow0u/psa_changes_to_the_masonnvim_registry/, and https://mason-registry.dev/registry/list#search, and https://github.com/williamboman/mason-lspconfig.nvim#default-configuration, and https://github.com/williamboman/mason.nvim#how-to-use-installed-packages
- [] feat(keybinding): z for going into undo tree mode (show undo tree, horizontal), change current z to y, reference: https://github.com/Microsoft/vscode/issues/20889#issuecomment-, https://github.com/mbbill/undotree
- [] feat(keymap): map every keybinding to a Dispatch (so that we can show help, and also easier to run test, this could also allow running commands on a set of selected editors)
- [] feat(dropdown): fuzzy search (https://docs.rs/fuzzy-matcher/0.3.7/fuzzy_matcher/trait.FuzzyMatcher.html#tymethod.fuzzy_indices)
- [] feat(quickfix): u/d = prev/next file
- [] feat(render): show highlight mode
- [] feat(v): change v = navigation history, b = bookmark mode
- [] feat(layout): default should be inverted-tall, where the largest pane is one the right, and the smaller panes are on the left. Why? Firstly, it's easier to look at the smaller pane that are on the left. Secondly, the code will be centered due to the left panes, making it easier to read the code. That's probably why VS Coder likes to keep their sidebar opened all the time during code.
- [] fix(selection_mode/syntax_tree): when going into syntax_tree mode from other mode, should prioritize selection of current line, same like going into outermost node mode
- [] feat(bookmark): b = save/unsave current selection into bookmarks, fb = find bookmarks, gb = global find bookmarks (question how bookmark recalibrate after auto-format?)
- [] fix(render): unicode causes extra padding
- [] feat(editor/other_movement): k = keep, r = remove selections matching certain criterion
- [] feat(title): window title and app title should be wrappable
- [] perf(insert): only store edit patch and reparse tree upon exit, don't compute them on every keystroke
- [] style(parent_lines): don't highlight the leading and trailing whitespaces of parent lines
- [] fix(hover-info): should be closed upon pressing esc in normal mode
- [] feat(git-hunk): l = unstaged against latest commit, shift+L = staged against latest commit, m = unstaged against master, shift+M = staged against master
- [] feat(dev): ci/cd
- [] feat: stack based language for modifying the content of each selections, example: `trim '1.' prepend`
- [] feat: for more sophisticated modifications like rotating the selections, we can push the metadata to the first stack
- [] feat(synax-highlight): don't udpate during insert mode, only update in normal mode
- [] feat(keymap): i = inside, o = outside, p=(, q=', d=", s=[, c={, b=` a=<, other symbol as is
- [] feat(prompt): show history at top, so that user can press up (or ctrl+p) to navigate to previous commands, like they do in shell
- [] feat(mode): surround, when in this mode, brackets, quotes becomes object, use u to select outer surrond, like syntax tree, how to change surround, use (r)aise, that's why raise has to work also in this mode
- [] keymap: change ma -> mm, so that ma can enter insert mode without pressing esc
- [] keymap: saving should clear all cursors, since they are useless after formatting
- [] ui: highlight mode indicator
- [] ui: show number of cursors
- [] feat(keymap idea): alt-movement for swapping, shift-movement for replacing
- [] feat(highlight): when quiting highlight mode, revert back to previous selection mode, this allow for more ergonomics usage such as deleting current line, then move on to the next selection (say search "hello")
- [] fix(ctrl+l): should be reset after moving selection, so that after moving selection I can always align to top
- [] feat(quickfix-list): do not repeat group name, easier for u/d to be understood, display result with hierarchy
- [] feat(exchange): exchange with first/last should not be literally exchanging with last or first, but rather move currrent select to first/last position
- [] feat(render): highlight all selections of non-contingous selection mode
- [] feat(editor): press \ to enter pure change selection mode (will not change the current selection)
- [] feat(omit): not working for quickfix list
- [] refactor(test_editor): should use DispatchEditor, not Editor's methods (should be private)
